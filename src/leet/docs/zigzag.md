# Z 字变形(Zigzag Transformation / Z 字形变换)

1. 定义
   Z 字变形是将 `一维数据(如字符串)` 或 `二维数据`, 以 `上下折线(zigzag 折返)`规律排列，再 `按行` 或 `对角线` 等方式输出
   - 它并 `不是真正严格的 Z 形(横➔斜➔横)`, 而是:
     - 从上到下竖向填充
     - 到底后斜向上填充
     - 再从上到下填充
     - 周期性折返
     - 形成 `锯齿折线`
     - `近似多个 N 拼接`, 而 `非严格 Z`

2. 应用场景
   - 字符串与矩阵遍历的变形题
     - 如 LeetCode 6. Zigzag Conversion
     - 矩阵遍历题(如对角线方向 `Z` 字扫描)
   - 图形模拟与 LCD 显示问题
     - LCD 显示模拟(模拟 `Z` 字闪烁效果)
   - 考察对数据结构行列下标灵活控制、边界处理能力
   
3. 字符串类 `Z` 字变形
   - Z 字形字符串变换，只 `需单循环 + 行指针 + 方向控制`, `不需要 while 或手动控制 for 的索引`
   ```text
   给定字符串 `PAYPALISHIRING`, 要求以 Z 字形排列:
   
   P   A   H   N
   A P L S I I G
   Y   I   R
   
   然后按行输出，得到结果 "PAHNAPLSIIGYIR"
   排列过程:
     - 从上到下填充至最后一行
     - 再从下往上斜着填充回第一行
     - 重复, 形成 `Z` 字折
   
   解:
   1. 从上到下填充
   Row 0: P
   Row 1: A
   Row 2: Y
   此时为:
   P
   A
   Y

   指针在 Row 2, 开始折回
   
   2. 从下往上斜着填充
   Row 1: P
   Row 0: A
   此时为:
   P   A 
   A P
   Y
   
   3. 从上到下填充
   Row 1: L
   Row 2: I
   此时为:
   P   A 
   A P L
   Y   I
   
   指针在 Row 2, 开始折回
   
   4. 从下往上斜着填充
   Row 1: S
   Row 0: H
   此时为:
   P   A   H
   A P L S
   Y   I
   
   5. 从上到下填充
   Row 1: I
   Row 2: R
   此时为:
   P   A   H
   A P L S I
   Y   I   R
   
   指针在 Row 2, 开始折回

   6. 从下往上斜着填充
   Row 1: I
   Row 0: N
   
   此时为:
   P   A   H   N
   A P L S I I
   Y   I   R
   
   7. 从上到下填充
   Row 1: G
   此时为:
   P   A   H   N
   A P L S I I G
   Y   I   R
   ```
   
4. 矩阵类 `Z` 字变形
   - 定义
     - `沿矩阵对角线, 呈 Z 字折线方向遍历矩阵的所有元素, 形成一维结果序列`
     - `并不是严格先横、再斜、再横的一次 Z，而是多次斜着折返形成锯齿形(类似字符串的 Z 字折返)`
     - 也称 `对角线遍历(Diagonal Traverse)`

   - 常见的二维矩阵 Z 字遍历有
     - `对角线 Z 字遍历`(如 `从左上 -> 右下`, 对角线依次扫描)
     - `蛇形 Z 字遍历`(`奇数行向右, 偶数行向左, 形成折线`)

   - `对角线 Z 字遍历`
    ```text
    对于一个 `m 行 n 列` 的矩阵
    起点: 左上角(0, 0)
    步骤:
    1. 沿对角线一直上升(从左下往右上), 如果到达边界, 向右或向下移一步
    2. 沿对角线一直下降(从右上往左下), 如果到达边界, 向右或向下移一步
    3. 重复以上步骤, 直到循环结束
   
    口诀: 沿对角线上升: 能右上就右上，遇边界优先右移，否则下移并切换方向;沿对角线下降: 能左下就左下，遇边界优先下移，否则右移并切换方向
    注: 必须沿水平方向（向右）或垂直方向（向下）先移一步，才能进入下一次对角线遍历
   
    边界:
        沿对角线上升:
        1. 如果在顶部(row = 0)且可以右移(col + 1 < n),  到达最右边边界，无法继续右上，向下移并切换方向
        2. 如果到达最右边边界(col == n - 1), 无法继续右上, 向下移并切换方向
        
        沿对角线下降:
        1. 到达底部边界(row == m - 1)，无法继续左下，向右移并切换方向
        2. 到达最左边界(col == 0), 向下移并切换方向
   
    时间复杂度: O(m * n)
    空间复杂度: O(1)
   
    举例:
    矩阵:
    1 2 3 
    4 5 6
    7 8 9 
   
    1. 从左上角出发，沿对角线上升(从左下往右上):
    -> 起点: (0, 0) = 1
    -> 沿对角线上升: 向右上 `(row - 1, col + 1) -> (-1, 1)` 移动, 行越界
    -> 到达边界, 无法继续, 停止
    -> 到达边界后，向右或向下移一步(上升 -> 右移)
    -> 可以右移, 右移一步, 到达 (0, 1) = 2
   
    2. 沿对角线下降(从右上往左下):
    -> 起点: 2
    -> 沿对角线下降: 向左下 (1, 0) 移动
    -> 到达边界, 无法继续, 停止
    -> 到达边界后，向右或向下移一步(下降 -> 下移)
    -> 可以下移, 下移一步, 到达 (2, 0) = 7
   
    3. 沿对角线上升(从左下往右上):
    -> 起点: (2, 0) = 7
    -> 沿对角线上升: 向右上 `(row - 1, col + 1) -> (1, 1)` 移动, 到达 (1, 1) = 5
    -> 沿对角线上升: 向右上 `(row - 1, col + 1) -> (0, 2)` 移动, 到达 (0, 2) = 3
    -> 到达边界, 无法继续, 停止
    -> 到达边界后，向右或向下移一步(上升 -> 下移)
    -> 不能右移, 只以下移, 下移我一步, 到达 (1, 2) = 6
   
    4. 沿对角线下降(从右上往左下):
    -> 起点: (1, 2) = 6
    -> 沿对角线下降: 向左下 (2, 1) 移动, 到达 (2, 1) = 8
    -> 到达边界, 无法继续, 停止
    -> 到达边界后，向右或向下移一步(下降 -> 右移)
    -> 无法下移, 只能右移, 到达 (2, 2) = 9
    -> 结束遍历
   
    最终: 1 → 2 → 7 → 5 → 3 → 6 → 8 → 9
    ```
   
   - 蛇形 Z 字遍历
   ```text
   1. 定义
      对矩阵按逐行遍历，但交替改变方向
      - 第 0 行 ➔ 从左往右遍历
      - 第 1 行 ➔ 从右往左遍历
      - 第 2 行 ➔ 从左往右遍历
      - 第 3 行 ➔ 从右往左遍历
      ...
      像蛇形在矩阵中左右摆动，形似 “Z” 的连续折线
   
   2. 特性
      - 行遍历(按行递增)
      - 列方向交替(左→右，右→左)
   
   3. 应用场景
      - 图像压缩 ZigZag 扫描(JPEG 编码)
      - 平铺时数据行列交错处理
      - 棋盘类题目行交替行走
      
   4. 步骤
      - 从第 0 行开始，逐行遍历到第 m-1 行（行递增）
      - 判断当前行号
        - 如果当前行号为偶数(row % 2 == 0), 沿水平方向 `从左往右` 遍历本行
        - 如果当前行号为奇数(row % 2 == 1), 沿水平方向 `从右往左` 遍历本行
   
   口诀: 行走不回头，左右来回游；偶行向右走，奇行往左溜
        - 行递增(从上往下)
        - 列方向交替(偶数行左→右，奇数行右→左)
   
   举例:
   矩阵：
   1  2  3  4 
   5  6  7  8 
   9 10 11 12
   
   遍历过程:
   1. 第 0 行, 从左向右
   1 → 2 → 3 → 4
   
   2. 第 1 行, 从右向左
   8 → 7 → 6 → 5

   3. 第 2 行, 从左向右
   9 → 10 → 11 → 12

   最终: 1 → 2 → 3 → 4 → 8 → 7 → 6 → 5 → 9 → 10 → 11 → 12
   ```
   
   - `蛇形 Z 字遍历` VS `对角线 Z 字遍历`
   ```text
   对比点     |    🐍 蛇形 Z 字遍历             | 🔺 对角线 Z 字遍历
   遍历方式   |    逐行遍历，行方向交替           | 沿对角线上升/下降遍历 
   行        |    依次递增                      | 非严格依次递增          
   列        |    按行交替左→右 / 右→左          | 非严格依次递增      
   应用      |    图像 ZigZag 扫描，压缩         | LeetCode 498，行列分布场景
   实现难度   |    简单                         | 中等         
   
   PS: 比对与对角线遍历效果不同，通常蛇形 Z 字遍历在行结构清晰时更适合      
   ```
   
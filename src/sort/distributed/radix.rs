/*!
    åŸºæ•°æ’åº(Radix Sort)
    éæ¯”è¾ƒå‹æ•´æ•°æ’åºç®—æ³•ï¼Œé€šè¿‡å°†æ•°æ®æŒ‰ä½(digit)åˆ†è§£å¹¶è¿›è¡Œå¤šæ¬¡æ’åºï¼Œæœ€ç»ˆå®Œæˆæ’åºçš„è¿‡ç¨‹ã€‚
    å®ƒé€‚ç”¨äºæ•´æ•°å’Œå­—ç¬¦ä¸²æ’åºï¼Œå°¤å…¶åœ¨æ•°æ®ä½æ•°è¾ƒå°‘æ—¶æ•ˆç‡æ›´é«˜ã€‚
    1. æ€æƒ³: ä»æœ€ä½ä½åˆ°æœ€é«˜ä½ä¾æ¬¡å¯¹æ•°æ®è¿›è¡Œæ’åº
    2. æ—¶é—´å¤æ‚åº¦:
       - å‡è®¾è¾“å…¥æ•°æ®çš„æ•°é‡ä¸º n, æœ€å¤§æ•°çš„ä½æ•°ä¸º d, æ¯æ¬¡ä½æ’åºçš„å¤æ‚åº¦ä¸º O(n + k)(k æ˜¯æ¯ä¸ªä½çš„åŸºæ•°, é€šå¸¸ä¸ºå¸¸æ•°), æ€»å¤æ‚åº¦ä¸º O(d * (n + k))
       - å½“åŸºæ•° ğ‘˜ æ˜¯å¸¸æ•°æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦è¿‘ä¼¼ä¸º O(d * n)
    3. ç©ºé—´å¤æ‚åº¦: è¾…åŠ©æ•°ç»„çš„å¤§å°ä¸º O(n + k), å› æ­¤ç©ºé—´å¤æ‚åº¦ä¸º O(n + k)
    4. ç‰¹ç‚¹:
       éæ¯”è¾ƒæ’åºï¼›é€‚åˆæ•´æ•°æ’åº
       - ä¼˜ç‚¹
         - ç¨³å®šæ’åºï¼šç›¸åŒå€¼çš„ç›¸å¯¹é¡ºåºä¸å˜ã€‚
         - å¯¹æŸäº›åˆ†å¸ƒèŒƒå›´æœ‰é™çš„æ•°æ®ï¼ˆå¦‚æ•´æ•°ï¼‰è¡¨ç°ä¼˜å¼‚ã€‚
         - é¿å…äº†æ¯”è¾ƒæ“ä½œï¼Œé€‚åˆæ’åºå¤§é‡æ•°æ®ã€‚
       - ç¼ºç‚¹
         - éœ€è¦é¢å¤–çš„å†…å­˜ç©ºé—´ã€‚
         - åªèƒ½ç”¨äºæ•´æ•°æˆ–èƒ½æ˜ å°„ä¸ºæ•´æ•°çš„æ•°æ®ï¼ˆå¦‚å­—ç¬¦ä¸²ï¼‰ã€‚

    æ­¥éª¤:
    1. æŒ‰ç…§æ•°å€¼çš„ `æ¯ä¸€ä½` è¿›è¡Œæ’åºï¼ˆä»ä½ä½åˆ°é«˜ä½ï¼Œæˆ–ä»é«˜ä½åˆ°ä½ä½ï¼‰
    2. å¯¹æ¯ä¸€ä½çš„æ’åºé€šå¸¸ä½¿ç”¨**è®¡æ•°æ’åºï¼ˆCounting Sortï¼‰**æˆ–ç¨³å®šæ’åºç®—æ³•æ¥ä¿è¯æ’åºçš„ç¨³å®šæ€§

    ä¸¾ä¾‹:
     å‡è®¾æœ‰ä¸€ç»„æ•´æ•°ï¼Œä½¿ç”¨åè¿›åˆ¶ä¸ºä¾‹: [170, 45, 75, 90, 802, 24, 2, 66]
     1. æ‰¾åˆ°æœ€å¤§æ•°ï¼Œç¡®å®šæ’åºçš„è½®æ•°ï¼š
        - æœ€å¤§æ•°ä¸º 802ï¼Œå®ƒæœ‰ 3 ä½æ•°ï¼Œå› æ­¤éœ€è¦æ’åº 3 æ¬¡ï¼ˆæŒ‰ä¸ªä½ã€åä½å’Œç™¾ä½ä¾æ¬¡æ’åºï¼‰
     2. æŒ‰ä¸ªä½æ•°æ’åºï¼š
       - æå–æ¯ä¸ªæ•°çš„ä¸ªä½ï¼š
        170 -> 0
        45 -> 5
        75 -> 5
        90 -> 0
        802 -> 2
        24 -> 4
        2 -> 2
        66 -> 6
       - æ’åºåï¼š[170, 90, 802, 2, 24, 45, 75, 66]
     3. æŒ‰åä½æ•°æ’åº
       - æå–æ¯ä¸ªæ•°çš„åä½
        170 -> 7
        90 -> 9
        802 -> 0
        2 -> 0
        24 -> 2
        45 -> 4
        75 -> 7
        66 -> 6
       - æ’åºåï¼š[802, 2, 24, 45, 66, 170, 75, 90]
      4. æŒ‰ç™¾ä½æ•°æ’åº
       - æå–æ¯ä¸ªæ•°çš„ç™¾ä½
        802 -> 8
        2 -> 0
        24 -> 0
        45 -> 0
        66 -> 0
        170 -> 1
        75 -> 0
        90 -> 0
       - æ’åºåï¼š[2, 24, 45, 66, 75, 90, 170, 802]
      æœ€ç»ˆç»“æœï¼š[2, 24, 45, 66, 75, 90, 170, 802]
*/
pub fn radix_sort(arr: &mut [u32]) {
    if arr.len() <= 1 {
        return;
    }

    // 1. æ‰¾åˆ°æœ€å¤§æ•°
    let max = *arr.iter().max().unwrap();

    // 2 ä½¿ç”¨è®¡æ•°æ’åº, å¯¹æ¯ä¸€ä½è¿›è¡Œæ’åº, ä»¥ä¿è¯å…¶ç¨³å®šæ€§
    // 2.1 è®¾å®šåŸºæ•° `exp = 1`
    let mut exp = 1; // æŒ‡æ•°ï¼Œè¡¨ç¤ºå½“å‰ä½ï¼š1 -> ä¸ªä½, 10 -> åä½ï¼Œä¾æ¬¡ç±»æ¨

    while max / exp > 0 {
        counting_sort(arr, exp);
        // 2.2 æå–æ¯ä¸ªæ•°çš„ä½æ•°, æŒ‰ä½æ•°æ’åº
        exp *= 10; // è¿›å…¥ä¸‹ä¸€ä½
    }
}

/// è®¡æ•°æ’åº
fn counting_sort(arr: &mut [u32], exp: u32) {
    // 1. åˆå§‹åŒ–è®¡æ•°æ•°ç»„
    let n = arr.len();

    // 1.1 è®¡æ•°æ•°ç»„é•¿åº¦ `k = æ•°ç»„é•¿åº¦ + 1`
    let k = 10; // æ¯ä¸ªä½çš„æ•°å­—èŒƒå›´æ˜¯ 0~9

    // 1.2 åˆå§‹åŒ–è®¡ç®—æ•°ç»„ count
    let mut count: Vec<u32> = vec![0; k];

    // 2. ç»Ÿè®¡è¾“å…¥æ•°ç»„å…ƒç´ å‡ºç°æ¬¡æ•°( + 1)
    for &num in arr.iter() {
        let digit = (num / exp % 10) as usize;
        count[digit] += 1;
    }

    // 3. è®¡ç®—ç´¯è®¡è®¡æ•°æ•°ç»„
    for i in 1..10 {
        count[i] += count[i - 1];
    }

    // 4. åå‘éå†æ•°ç»„ï¼Œå¹¶å°†å…ƒç´ æ”¾åˆ°æ’åºç»“æœæ•°ç»„çš„æ­£ç¡®ä½ç½®
    // 4.1 å®šä¹‰ç»“æœé›† results
    let mut results = vec![0; n];
    for &num in arr.iter().rev() {
        // è®¡ç®— x
        let digit = (num / exp % 10) as usize;

        // 4.2 è·å–æ•°ç»„å…ƒç´  `x` çš„ç´¢å¼•ç¬¬ä¸€ä¸ªä½ç½®, `index = count[x] - 1`
        let index = count[digit] - 1;

        // 4.3 æŠŠ `x` æ”¾åˆ°ç»“æœé›† `results` ä¸­æ­£ç¡®çš„ä½ç½®, `results[index] = x`
        results[index as usize] = num;

        // 4.4 è®¡ç®—æ•°ç»„å‡å°‘ä¸€ä½, count[x] -= 1
        count[digit] -= 1;
    }

    // 5. è¾“å‡ºæ’åºç»“æœ
    arr.copy_from_slice(&results);
}

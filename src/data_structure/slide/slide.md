# 滑动窗口
  滑动窗口是一种在 `连续区间上进行子区间枚举与计算` 的高效技巧, 用于
  - 遍历子串、子数组、子区间
  - 保持窗口内满足某种条件
  - 实时更新窗口状态，避免重复计算

1. 核心思想
   - 在数组/字符串上维护一个 `[left, right]` 区间(即窗口)
   - 每次窗口右端右移以扩展窗口(让窗口包含更多元素)
   - 当窗口不满足条件时, 通过左端右移来收缩窗口
   - `只在需要时移动窗口边界, 从而避免重复遍历窗口内所有元素`

2. 特性
   - 高效性
     - 通常可以将枚举所有长度为 `k` 的子区间时间复杂度从 `O(nl) 优化成 `O(n)`
     - 不用重复计算窗口内的元素和或状态
   - 适用范围
     - 在 `连续子串/子数组` 问题中高效寻找
       - 固定长度窗口(长度 `k`)
       - 不定长度窗口(最小/最大满足条件窗口)
     - 常用于
       - 子数组最大/最小和
       - 字符串匹配中的窗口枚举(如 `Rabin-Karp`、`BM` 等)
       - 最长无重复子串、最短覆盖子串
       - 求最大/最小值、和、频率等窗口内统计
       
3. 时间复杂度
   - 一般为 `O(n)`
     - 因为窗口左右端最多移动 `n` 次
   - 某些情况下
     - 需要窗口内部做额外操作时可能有额外 `O(log k)`(如: 窗口内求最大值时用单调队列/堆)
     
4. 空间复杂度
   - 一般为 `O(k)`(窗口长度)
   - 如果需要维护哈希表/计数表
     - 若字符集/元素有限, 空间通常是 `O(σ)(σ = 字符集大小)`
     - 若动态维护元素出现次数, 空间取决于不同元素的数量
   
5. 使用场景
   - 网络传输 / 数据流处理
     - TCP 流量控制
       - TCP 会话通过滑动窗口控制数据包的发送和确认范围，防止拥塞
       - 窗口大小动态调整，根据网络状态滑动
       - 实际例子
         - 在 `高吞吐量文件传输` 中，通过滑动窗口确保可以持续发送一定范围内未确认的数据包
     - 实时数据流统计
       - 对实时日志流、loT设备数据流，持续计算:
         - 最近 1 分钟平均值
         - 最近 1 分钟最大值/最小值
         - 最近 N 条数据统计
       - 实际例子
         - 实时监控温度传感器，计算过去 10 秒的最高温度
   - 金融领域
     - 股票价格移动平均
       - 股票图表常见的 `MA`(Moving Average 移动平均线)
         - 5 日 / 10 日 / 30 日 均线
       - 本质是维护一个长度固定的滑动窗口求和 / 求平均
     - 高频交易
       - 实时检测过去 N 秒内的交易频率、成交量极值
       - 检测价格波动是否超过阈值(如最近 1000 条交易内最大价格差)
   - 系统监控
     - 服务器健康检测
       - CPU 使用率过去 1 分钟平均值超过 80% 告警
       - 请求响应延迟的滑动窗口最大值监控
       - 在 Prometheus、Datadog 等监控系统中常见
   - 图像/视频处理
     - 图像滤波(滑动窗口卷积)
       - 图像中应用 卷积核在图像像素矩阵上滑动，计算局部平均、加权平均、边缘检测等
       - 视频中处理每一帧时，可维护滑动窗口做帧间降噪、运动检测
   - 安全领域
     - 恶意流量检测
       - 在流量包序列中，维护过去 N 包数据特征滑动窗口，检测是否出现恶意模式
         - 检测异常登录行为
           - 滑动窗口检测过去 10 分钟登录次数是否超过阈值
   - 搜索与字符串匹配
     - 文本去重
       - `Rabin-Karp` 滑动窗口哈希用于海量文本重复检测
       - 实时流式文本(如新闻、社交平台推文)中滑动窗口匹配敏感词
     - 日志检测
       - 在实时日志流中匹配错误模式
         - 滑动窗口维护最近 N 条日志，检测是否符合某错误序列模式
   - 内存与缓存管理
     - LRU 缓存淘汰策略
       - 本质上维护滑动窗口(或近似窗口)确定最近最少使用的数据，动态淘汰旧数据
   - 数据压缩与去重
     - Rabin Fingerprinting
       - BUP、rsync、Deduplication 使用 Rabin Fingerprinting 滑动窗口分块
         - 滑动窗口固定大小计算哈希，如果哈希满足条件(如末位若干位为零)，则作为块边界
         - 实现去重和增量同步
   - 算法竞赛与刷题
     - 滑动窗口在 `LeetCode / Codeforces / Atcoder` 中常用于
       - 最长无重复子串(LC 3)
       - 长度为 K 的子数组最大和(LC 643)
       - 最短覆盖子串(LC 76)
       - 滑动窗口最大值(LC 239)
       - 判断字符串排列(LC 567)

5. 举例
   ```text
   nums = [2, 1, 5, 1, 3, 2]
   k = 3
   
   1. 初始化
   left = 0
   right = 0
   window_sum = 0
   max_sum = 0
   
   2. 窗口向右滑动
   遍历
   right = 0
   -> 加入第一个元素 nums[0] = 2
   -> window_sum += 2 = 2
   -> 窗口长度未达到 k, 继续扩张
   -> right += 1 = 1
   
   right = 1
   -> 加入第二个元素 nums[1] = 1
   -> window_sum += 1 = 3
   -> 窗口长度未达到 k, 继续扩张
   -> right += 1 = 2
   
   right = 2
   -> 加入第三个元素 nums[2] = 5
   -> window_sum += 5 = 8
   -> 窗口长度达到 k(k = 3)
   -> 更新最大值 max_sum = max(0, 8) = 8
   -> 收缩窗口左端: left += 1 = 1
   -> 移除左边第一个元素: window_sum -= 2 = 6
   -> right += 1 = 3
   
   right = 3
   -> 加入第四个元素 nums[3] = 1
   -> window_sum += 1 = 7
   -> 窗口长度达到 k(k = 3)
   -> 更新最大值 max_sum = max(8, 7) = 8
   -> 收缩窗口左端: left += 1 = 2
   -> 移除左边第一个元素: window_sum -= 1 = 6
   -> right += 1 = 4
   
   right = 4
   -> 加入第五个元素 nums[4] = 3
   -> window_sum += 3 = 9
   -> 窗口长度达到 k(k = 3)
   -> 更新最大值 max_sum = max(8, 9) = 9
   -> 收缩窗口左端: left += 1 = 3
   -> 移除左边第一个元素: window_sum -= 3 = 6
   -> right += 1 = 5
   
   right = 5
   -> 加入第五个元素 nums[5] = 2
   -> window_sum += 2 = 8
   -> 窗口长度达到 k(k = 3)
   -> 更新最大值 max_sum = max(9, 8) = 9
   -> 收缩窗口左端: left += 1 = 4
   -> 移除左边第一个元素: window_sum -= 2 = 6
   -> right += 1 = 6
   
   right = 6
   -> 越界, 结束
   ```
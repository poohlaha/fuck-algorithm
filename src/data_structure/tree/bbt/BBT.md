# 平衡二叉树(Balanced Binary Tree, BBT)
  平衡二叉树是一种特殊的 `二叉搜索树(BST)`，它保证了左右子树的高度差不会超过一定的范围，从而提高查询效率。常见的平衡二叉树包括 `AVL 树`、`红黑树`、`B 树` 等。

1. 定义
  - 它是一棵二叉搜索树(BST)，即对于任意节点 N，左子树的所有节点值都小于 N，右子树的所有节点值都大于 N
  - 它的任意节点的左右子树高度差（平衡因子）不超过 1, 即:
    ```
    平衡因子 = 左子树的高度 − 右子树的高度
    ```
    其值只能是 `-1`、`0` 或 `1`

2. 示例
   - 平衡二叉树
   ```
       10
      /  \
     5    15
    / \   / \
   2   7 12 20
   ```
     - 对于根节点 10
      - 左子树（5）的高度 = 2
      - 右子树（15）的高度 = 2
      - 平衡因子 = 2 - 2 = 0（符合平衡二叉树的要求）
     - 对于其他节点（5、15、2、7、12、20），其左右子树高度差都不超过 1，因此该树是平衡的
 
   - 非平衡二叉树
   ```
         10
        /  
       5    
      / 
     2   
    /
   1
   ```
    - 对于根节点 10
      - 左子树（5）的高度 = 3
      - 右子树的高度 = 0
      - 平衡因子 = 3 - 0 = 3（超过 1，违反平衡二叉树的规则）
    - 该树偏向左侧，导致查询效率下降，因此它 `不是平衡二叉树`

3. 常见的平衡二叉树
   - AVL 树: 通过**旋转（单旋转、双旋转）**操作保持平衡，适用于需要频繁查询的情况
   - 红黑树：通过**颜色标记和调整（变色、旋转）**保持平衡，适用于插入和删除操作较多的情况（如 Java 的 TreeMap 和 TreeSet） 
   - B 树 / B+ 树：用于数据库索引，能存储大量数据并保证高效查询
   
4. 优点
   - 提高查询效率：由于树的高度受控，查找、插入、删除的时间复杂度为 O(log n)
   - 避免退化为链表：普通二叉搜索树在极端情况下可能退化为链表（O(n)），而平衡二叉树可以防止这种情况
   
5. 使用场景
   平衡二叉树因其 O(log n) 的查找、插入和删除时间复杂度，被广泛应用于需要 `高效数据存储` 和 `查找` 的场景。以下是几个主要的应用场景
   - 数据库索引
     - B 树（B-Tree）/ B+ 树 是数据库索引的核心数据结构，底层通常是平衡二叉树变种
     - 应用场景:
       - MySQL 的 InnoDB 引擎使用 B+ 树索引 来加速查询（比如 PRIMARY KEY 索引和 SECONDARY INDEX）
       - MongoDB 也使用 B-Tree 结构进行索引管理
       
   - 操作系统
     - 调度算法：任务调度器中可能使用平衡二叉树来维护优先级队列，例如 Linux CFS 调度器使用红黑树
     - 内存管理
       - Linux 的 malloc() 实现（如 glibc 中的 ptmalloc）会用 `红黑树` 管理空闲内存块，支持快速分配和回收
       - `虚拟内存页表` 可能会使用 AVL 树来高效组织地址空间映射
   
   - 编程语言的集合类  
   许多高级语言的 `有序集合(Set)` 和 `映射(Map)` 使用 `红黑树(Red-Black Tree)` 作为底层数据结构
     - Java
       - TreeMap 和 TreeSet 基于 `红黑树`，提供 O(log n) 级别的查找、插入和删除操作
     - C++ STL
       - std::map 和 std::set 也是基于 `红黑树` 实现的
     - Rust
       - BTreeMap 和 BTreeSet 采用 `B 树`，适用于大数据存储
     - Python
       - sortedcontainers 库提供了 `基于 AVL 树的有序集合`
   
   - 网络路由(IP 查找)     
     - BGP（边界网关协议）路由表查找
       - 互联网中的 BGP 协议用于维护路由表，`红黑树/AVL` 树 可以帮助快速查找 IP 前缀匹配项
     - 负载均衡（Load Balancing）
       - 平衡二叉树有助于维护服务器节点列表，进行 `高效的查找和负载分配`
   
   - 文件系统
     - `Ext3/Ext4` 文件系统使用 `平衡二叉树` 来索引文件块，提高文件读写效率
     - `NTFS` 文件系统使用 `B+` 树 作为目录索引，支持高效的文件查找操作
     
   - 游戏开发
     - 碰撞检测(Collision Detection):
       - 在 `2D/3D` 游戏 中，需要管理大量的 `对象（如玩家、NPC、子弹）`，使用 `平衡二叉树（如 AABB 树、四叉树）` 进行区域查询，能加速检测效率
     - 人工智能（AI）决策树
       - 游戏 AI 可能使用 平衡二叉树 来存储决策路径，提升计算效率
   
   - 股票交易系统
     - 高频交易系统（HFT） 需要快速处理买卖订单:
       - 订单匹配引擎 可能使用 `红黑树` 维护 有序订单簿，保证高效的买卖撮合
       - 例如 NASDAQ 的交易系统 可能会用平衡二叉树管理订单优先级
   
   - 语法解析器(Compiler Parsing)    
     - 编译器（Compiler） 需要解析和优化代码
       - 语法树（Syntax Tree） 可能是 `平衡二叉树`，如 AST（Abstract Syntax Tree）
       - 查找符号表（Symbol Table） 时，可能使用 红黑树/AVL 树 进行高效查找
   
   - 区块链与加密货币    
     - `Merkle 树(平衡二叉哈希树)` 在比特币、以太坊等区块链系统中用于存储交易数据，提高数据完整性和验证速度

```
应用领域	        具体应用
数据库	        MySQL B+ 树索引、MongoDB
操作系统	        任务调度器（CFS）、内存管理（glibc malloc）
编程语言	        Java TreeMap、C++ std::map、Rust BTreeMap
网络路由	        BGP 路由表、负载均衡
文件系统	        Ext4、NTFS
游戏开发	        碰撞检测、AI 决策树
股票交易	        高频交易订单匹配
编译器	        语法解析树、符号表
区块链	        Merkle 树
```  